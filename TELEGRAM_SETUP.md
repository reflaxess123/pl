# Настройка Telegram UserBot

## Получение API ключей

1. **Перейдите на https://my.telegram.org**
2. **Войдите с помощью номера телефона**
3. **Перейдите в раздел "API development tools"**
4. **Создайте новое приложение:**

   - **App title**: `ProxyAPI GPT Bot` (или любое другое название)
   - **Short name**: `pl-bot` (или любое другое)
   - **Platform**: `Desktop`
   - **Description**: `Personal assistant bot`

5. **Скопируйте полученные данные:**
   - `api_id` (число)
   - `api_hash` (строка)

## Настройка переменных окружения

Добавьте в файл `.env`:

```env
# Telegram API credentials
TELEGRAM_API_ID=1234567
TELEGRAM_API_HASH=abcdef1234567890abcdef1234567890
TELEGRAM_PHONE=+7XXXXXXXXXX
```

**⚠️ Важно:**

- `TELEGRAM_PHONE` должен включать код страны (например, `+79991234567`)
- При первом запуске вам придет SMS с кодом подтверждения

## Запуск UserBot

### Простая версия (только команды @pl-):

```bash
python pl/cli.py telegram
```

### Расширенная версия (с дополнительными командами):

```bash
python pl/cli.py telegram --advanced
```

## Команды с контекстом

Для включения контекста используйте формат: `@gpt-contextN-команда`

**Примеры:**

- `@gpt-context3-rewrite этот текст` - переформулировать с учетом 3 последних сообщений
- `@gpt-context5-объясни что это` - объяснить с контекстом из 5 сообщений
- `@gpt-context50-продолжи мысль` - продолжить с контекстом из 50 сообщений

## Open команды (показать исходное сообщение + ответ)

Добавьте `-open` к любой команде, чтобы сохранить исходный текст:

**Без контекста:**

- `@gpt-open-rewrite Переформулируй этот текст`
- `@gpt-open-translate Hello world`
- `@gpt-open-объясни что такое ИИ`

**С контекстом:**

- `@gpt-context10-open-найди информацию о том-то` - найти в последних 10 сообщениях
- `@gpt-context50-open-rewrite этот текст` - переформулировать с контекстом из 50 сообщений

**Результат open команды:**

```
Ваше исходное сообщение

Ответ GPT:
Ответ от искусственного интеллекта
```

**Контекст:**

- N может быть от 1 до 50
- GPT получит предыдущие сообщения из чата
- Полезно для диалогов и уточняющих вопросов
- ⚠️ **Важно**: Учитываются только текстовые сообщения, поэтому реальное количество может быть меньше запрошенного (если в чате есть фото, стикеры, голосовые)

## Доступные команды

### Простая версия:

- `@gpt-Переформулируй этот текст` - любой запрос к GPT

### Расширенная версия:

- `@gpt-rewrite Текст` - переформулировать текст
- `@gpt-translate Text` - перевести на русский
- `@gpt-explain Что-то сложное` - объяснить простыми словами
- `@gpt-fix Текст с ашибками` - исправить ошибки
- `@gpt-short Длинный текст` - сократить текст
- `@gpt-Любой другой запрос` - общие вопросы

### Команды с контекстом:

- `@gpt-context3-rewrite Текст` - переформулировать с контекстом
- `@gpt-context5-объясни это` - объяснить с учетом предыдущих сообщений
- `@gpt-context50-продолжи мысль` - продолжить с большим контекстом

### Open команды:

- `@gpt-open-rewrite Текст` - переформулировать, показав исходное сообщение
- `@gpt-context10-open-найди информацию` - найти с контекстом, показав вопрос

## Как это работает

1. **Вы пишете сообщение** начинающееся с `@gpt-` в любом чате
2. **UserBot перехватывает** ваше исходящее сообщение
3. **Отправляет запрос** к GPT-4o mini через ProxyAPI
4. **Обычный режим**: заменяет ваше сообщение на ответ от GPT
5. **Open режим**: дополняет ваше сообщение ответом от GPT

## Безопасность

- ⚠️ **UserBot работает с вашим аккаунтом**, будьте осторожны
- ✅ **Обрабатываются только ваши исходящие сообщения** с префиксом `@gpt-`
- ✅ **Никакие данные не сохраняются** локально
- ✅ **Исходный код открыт** для проверки

## Настройка системного промпта

UserBot использует специальный системный промпт для работы в Telegram. Вы можете настроить его:

### Через переменную окружения

Добавьте в файл `.env`:

```env
SYSTEM_PROMPT=Ты - мой персональный ассистент в Telegram. Пиши кратко и естественно.
```

### Примеры хороших промптов для Telegram:

**Краткий стиль:**

```
Ты - мой персональный ассистент. Отвечай кратко, без лишних слов.
```

**Дружелюбный стиль:**

```
Ты - мой друг-ассистент в Telegram. Общайся непринужденно, используй эмодзи.
```

**Деловой стиль:**

```
Ты - мой деловой помощник. Отвечай четко, структурированно, по существу.
```

## Остановка

Нажмите `Ctrl+C` в терминале для остановки UserBot.
